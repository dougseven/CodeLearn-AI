{
    "lesson": "# Python Metaclasses and Class Creation\n\n## Introduction\nMetaclasses are Python's class factories - they create and customize classes. While C# uses attributes and reflection for similar purposes, Python's metaclasses offer more direct control over class creation.\n\n## Concept Overview\nA metaclass is a class whose instances are classes. Just as a class defines how an instance behaves, a metaclass defines how a class behaves.\n\n## Syntax\n```python\n# Basic metaclass example\nclass MyMetaclass(type):\n    def __new__(cls, name, bases, attrs):\n        # Modify class attributes here\n        return super().__new__(cls, name, bases, attrs)\n\nclass MyClass(metaclass=MyMetaclass):\n    pass\n```\n\n```python\n# Practical metaclass example\nclass LoggedMeta(type):\n    def __new__(cls, name, bases, attrs):\n        # Add logging to all methods\n        for key, value in attrs.items():\n            if callable(value):\n                attrs[key] = lambda *args, **kwargs: print(f'Calling {key}') or value(*args, **kwargs)\n        return super().__new__(cls, name, bases, attrs)\n```\n\n## Key Points\n- Metaclasses intercept class creation\n- They can modify class attributes, methods, and behavior\n- type() is Python's default metaclass\n- Similar to C#'s TypeBuilder but more flexible\n\n## Common Mistakes\n- Overusing metaclasses when simpler solutions exist\n- Forgetting to call super().__new__()\n- Modifying built-in types\n\n## Practice\nCreate a metaclass that:\n1. Validates class attributes\n2. Adds automatic property getters/setters\n3. Implements singleton pattern\n",
    "challenge": "# Create a metaclass that implements the singleton pattern\n\ndef create_singleton_metaclass():\n    \"\"\"Create a metaclass that ensures only one instance of a class can exist.\n    \n    Requirements:\n    1. Any class using this metaclass should only create one instance\n    2. Subsequent instantiations should return the same instance\n    3. Handle inheritance correctly\n    \n    Returns:\n    - A metaclass that implements the singleton pattern\n    \"\"\"\n    pass",
    "tests": [
        "def test_singleton_instance():\n    SingletonMeta = create_singleton_metaclass()\n    class MyClass(metaclass=SingletonMeta): pass\n    instance1 = MyClass()\n    instance2 = MyClass()\n    assert instance1 is instance2",
        "def test_singleton_inheritance():\n    SingletonMeta = create_singleton_metaclass()\n    class Parent(metaclass=SingletonMeta): pass\n    class Child(Parent): pass\n    assert Child() is Child()",
        "def test_singleton_multiple_classes():\n    SingletonMeta = create_singleton_metaclass()\n    class ClassA(metaclass=SingletonMeta): pass\n    class ClassB(metaclass=SingletonMeta): pass\n    assert ClassA() is not ClassB()"
    ]
}