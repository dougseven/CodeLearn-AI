{
    "lesson": "# Deep Magic Methods in Python: Powering Frameworks\n\n## Introduction\n\nMagic methods (also called dunder methods) are special methods in Python that enable powerful metaprogramming and framework-level functionality. They allow developers to customize object behavior at a fundamental level.\n\n## Concept Overview\n\nMagic methods provide hooks into Python's object model, allowing you to define how objects behave in various contexts. Unlike C# with its explicit interfaces, Python uses these methods to implement dynamic behavior.\n\n## Key Magic Methods\n\n### 1. `__call__`: Turning Objects into Callable Functions\n```python\nclass Multiplier:\n    def __init__(self, factor):\n        self.factor = factor\n    \n    def __call__(self, x):\n        return x * self.factor\n\n# Usage\ndouble = Multiplier(2)\nprint(double(5))  # Outputs: 10\n```\n\n### 2. `__enter__` and `__exit__`: Context Management\n```python\nclass DatabaseConnection:\n    def __enter__(self):\n        # Setup database connection\n        return self\n    \n    def __exit__(self, exc_type, exc_val, exc_tb):\n        # Cleanup and close connection\n        pass\n\n# Usage with context manager\nwith DatabaseConnection() as db:\n    db.execute_query()\n```\n\n### 3. `__getattr__` and `__setattr__`: Dynamic Attribute Handling\n```python\nclass FlexibleDict:\n    def __init__(self):\n        self._data = {}\n    \n    def __getattr__(self, name):\n        return self._data.get(name)\n    \n    def __setattr__(self, name, value):\n        if name == '_data':\n            super().__setattr__(name, value)\n        else:\n            self._data[name] = value\n```\n\n## Key Points\n\n- Magic methods allow deep customization of object behavior\n- They are called automatically by Python in specific contexts\n- Provide a way to implement protocol-like behaviors\n- Can be used to create domain-specific languages (DSLs)\n\n## Common Mistakes\n\n- Overusing magic methods can make code less readable\n- Forgetting to call parent class methods with `super()`\n- Implementing magic methods incorrectly can break expected behavior\n\n## Practice Exercises\n\n1. Create a `LazyProperty` decorator that caches method results\n2. Implement a custom container with `__len__`, `__getitem__`, and `__iter__`\n3. Build a simple ORM-like class that uses magic methods for attribute mapping\n\n## Advanced Considerations\n\n- Magic methods are similar to C# extension methods and operator overloading\n- They provide more dynamic capabilities compared to C# static interfaces\n- Can be used to create fluent interfaces and DSLs\n",
    "challenge": "# Challenge: Implement a Flexible Configuration Object\n\nCreate a configuration management class that demonstrates advanced magic method usage:\n\n1. Support dot notation and dictionary-style access\n2. Allow nested configuration with recursive resolution\n3. Implement `__getattr__`, `__setattr__`, and `__repr__` methods\n4. Support default values and type conversion\n5. Provide a way to freeze the configuration after initialization\n\nRequirements:\n- Must handle nested configurations\n- Support type conversion (int, str, bool)\n- Prevent modification after freezing\n- Provide clear string representation\n\ndef create_config(initial_data=None):\n    # Your implementation here\n    pass\n",
    "tests": [
        "import pytest\nfrom solution import create_config\n\ndef test_basic_configuration():\n    config = create_config({\n        'database': {\n            'host': 'localhost',\n            'port': 5432\n        },\n        'debug': True\n    })\n    \n    assert config.database.host == 'localhost'\n    assert config.database.port == 5432\n    assert config.debug is True\n\ndef test_nested_access():\n    config = create_config({\n        'services': {\n            'api': {\n                'url': 'https://example.com',\n                'timeout': 30\n            }\n        }\n    })\n    \n    assert config.services.api.url == 'https://example.com'\n    assert config.services.api.timeout == 30\n\ndef test_configuration_freezing():\n    config = create_config({'key': 'value'})\n    config.freeze()\n    \n    with pytest.raises(AttributeError):\n        config.new_key = 'test'\n    \n    with pytest.raises(AttributeError):\n        config.key = 'modified'"
    ]
}